{"version":3,"file":"public\\javascripts\\app.js","sources":["app/application.js","app/initialize.js","app/lib/router.js","app/lib/view_helper.js","app/models/cart.js","app/models/carts.js","app/models/collection.js","app/models/model.js","app/models/product.js","app/models/products.js","app/models/receipt.js","app/models/receipts.js","app/models/recipe.js","app/models/recipes.js","app/models/to_cook.js","app/views/cart.js","app/views/carts.js","app/views/home.js","app/views/kitchen.js","app/views/product.js","app/views/products.js","app/views/receipt.js","app/views/receipts.js","app/views/recipe.js","app/views/recipes.js","app/views/templates/cart.jade","app/views/templates/carts-recipes.jade","app/views/templates/carts.jade","app/views/templates/home.jade","app/views/templates/kitchen.jade","app/views/templates/product.jade","app/views/templates/products.jade","app/views/templates/receipt-detail.jade","app/views/templates/receipt.jade","app/views/templates/receipts.jade","app/views/templates/recipe.jade","app/views/templates/recipes.jade","app/views/templates/to_cooks.jade","app/views/to_cook.js","app/views/to_cooks.js","app/views/view.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AANA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;A,CCAA;;AACA;AADA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhFA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArQA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxKA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnFA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9CA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnDA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;;A","sourcesContent":["// Application bootstrapper.\r\nvar Application = {\r\n    initialize: function () {\r\n        var HomeView = require('views/home'), Router = require('lib/router');\r\n        this.homeView = new HomeView();\r\n        this.router = new Router();\r\n        if (typeof Object.freeze === 'function') {\r\n            Object.freeze(this);\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = Application;\r\n","var application = require('application');\r\n\r\n$(function () {\r\n  application.initialize();\r\n  Backbone.history.start();\r\n});\r\n","var application = require(\"application\");\r\n\r\nmodule.exports = Backbone.Router.extend({\r\n    routes: {\r\n        \"\": \"home\"\r\n    },\r\n\r\n    home: function () {\r\n        $(\"body\").html(application.homeView.render().el);\r\n    }\r\n});\r\n","// Put your handlebars.js helpers here.\r\n","var Model = require(\"./model\");\r\n\r\nmodule.exports = Model.extend({\r\n    \"urlRoot\": \"carts\"\r\n});\r\n","var Collection = require(\"./collection\"),\r\n    Cart       = require(\"./cart\");\r\n\r\nmodule.exports = Collection.extend({\r\n    \"model\": Cart,\r\n    \"url\": \"carts\"\r\n});\r\n","// Base class for all collections.\r\nmodule.exports = Backbone.Collection.extend({\r\n});\r\n","// Base class for all models.\r\nmodule.exports = Backbone.Model.extend({\r\n});\r\n","var Model = require(\"./model\");\r\n\r\nmodule.exports = Model.extend({\r\n    \"urlRoot\": \"products\",\r\n\r\n    // TODO: allow different places\r\n    \"urlImageRoot\": \r\n        \"http://drive.intermarche.com/ressources/images/produit/zoom/\",\r\n    \"noImageUrl\": \"images/product.png\",\r\n    \"urlImageExt\": \".jpg\", \r\n\r\n    \"normalizeName\": function (name) {\r\n        return name.replace(/[\\/&?%= ]/g, \"-\");\r\n    },\r\n\r\n    \"initialize\": function (params) {\r\n        if (!params.normalizedName) {\r\n            this.set(\"normalizedName\", this.normalizeName(params.name));\r\n        }\r\n        if (!params.image) {\r\n            this.set(\"image\", this.noImageUrl);\r\n        }\r\n    },\r\n\r\n    \"iBarCode\": function (bar12) {\r\n        var even,\r\n            odd,\r\n            checksum = \"\",\r\n            i;\r\n\r\n        if (bar12.lenght === 12) {\r\n            even = 0 ;\r\n            odd  = 0 ;\r\n\r\n            for (i = 0; i < 6; i++) {\r\n                even += parseInt(bar12[2 * i + 1]);\r\n                odd  += parseInt(bar12[2 * i]);\r\n            }\r\n            checksum = 10 - (3 * even + odd) % 10 ;\r\n        }\r\n\r\n        return \"0\" + bar12 + checksum.toString() ;\r\n    }\r\n\r\n});\r\n","var Collection = require(\"./collection\"),\r\n    Product    = require(\"./product\");\r\n\r\nmodule.exports = Collection.extend({\r\n    \"model\": Product,\r\n    \"url\": \"products\",\r\n\r\n    \"addProduct\": function (product) {\r\n        var iUrl = Product.prototype.urlImageRoot,\r\n            iExt = Product.prototype.urlImageExt,\r\n            product;\r\n\r\n        product = new Product ({\r\n            \"name\": product.label,\r\n            \"quantity\": product.amount,\r\n            \"price\": product.price,\r\n            \"image\": iUrl + Product.prototype.iBarCode(product.barcode) + iExt\r\n        });\r\n        if ($.trim(product.get(\"name\").toLowerCase()) !== \"nr\") {\r\n            product.save();\r\n        }\r\n    },\r\n\r\n    \"updateProduct\": function (data, detail) {\r\n        var product = new Product(data);\r\n        if (detail.amount) {\r\n            product.set(\"quantity\", product.get(\"quantity\") + detail.amount);\r\n            if (detail.price) {\r\n                product.set(\"price\", detail.price / detail.amount);\r\n            }\r\n        }\r\n        product.save();\r\n    },\r\n\r\n    \"updateProducts\": function (details, callback, update) {\r\n        // TODO: add a field without special caracters different\r\n        //       from the full name\r\n        var that = this,\r\n            label,\r\n            detail;\r\n\r\n        if (details.length) {\r\n            detail = details[0];\r\n            if (detail.label && detail.label) {\r\n                label = Product.prototype.normalizeName(detail.label);\r\n                $.ajax({\r\n                    \"dataType\": \"json\",\r\n                    \"url\": \"products/name/\" + label,\r\n                    \"success\": function (data) {\r\n                        update.apply(this, [data, detail])\r\n                        that.updateProducts(details.slice(1), callback, update);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            callback.call();\r\n        }\r\n    },\r\n\r\n    \"addProducts\": function (details, callback) {\r\n        var that = this;\r\n        this.updateProducts(details, callback, function (data, detail) {\r\n            if (data.length === 0) {\r\n                that.addProduct(detail);\r\n            } else {\r\n                that.updateProduct(data[0], detail);\r\n            }\r\n        });\r\n    },\r\n\r\n    \"removeProducts\": function (details, callback) {\r\n        var that = this;\r\n        this.updateProducts(details, callback, function (data, detail) {\r\n            if (data.length > 0) {\r\n                that.updateProduct(data[0], detail);\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","var Model = require(\"./model\");\r\n\r\nmodule.exports = Model.extend({\r\n    \"urlRoot\": \"receipts\"\r\n});\r\n","var Collection = require(\"./collection\"),\r\n    Receipt    = require(\"./receipt\");\r\n\r\nmodule.exports = Collection.extend({\r\n    \"model\": Receipt,\r\n    \"url\": \"receipts\"\r\n});\r\n","var Model = require(\"./model\");\r\n\r\nmodule.exports = Model.extend({\r\n    \"urlRoot\": \"recipes\"\r\n});\r\n","var Collection = require(\"./collection\"),\r\n    Recipe     = require(\"./recipe\");\r\n\r\nmodule.exports = Collection.extend({\r\n    \"model\": Recipe,\r\n    \"url\": \"recipes\"\r\n});\r\n","var Collection = require(\"./collection\"),\r\n    Recipe     = require(\"./recipe\");\r\n\r\nmodule.exports = Collection.extend({\r\n    \"model\": Recipe,\r\n    \"url\": \"recipes/to-cook\"\r\n});\r\n","var View     = require(\"./view\"),\r\n    Cart     = require(\"../models/cart\"),\r\n    template = require(\"./templates/cart\");\r\n\r\nmodule.exports = View.extend({\r\n    \"tagName\": \"li\",\r\n    \"className\": \"cart col-xs-6\",\r\n    \"template\": template,\r\n\r\n    \"model\": Cart,\r\n\r\n    \"getRenderData\": function () { \r\n        var attributes = this.model.attributes;\r\n        return attributes;\r\n    },\r\n\r\n    \"initialize\": function () {\r\n        this.render();\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .delete\": \"destroy\",\r\n    },\r\n\r\n    \"destroy\": function () {\r\n        var that = this;\r\n\r\n        that.model.destroy({\r\n            \"success\": function () {\r\n                that.remove();\r\n            }\r\n        });\r\n    },\r\n\r\n});\r\n\r\n","var View            = require(\"./view\"),\r\n    Cart            = require(\"../models/cart\"),\r\n    Carts           = require(\"../models/carts\"),\r\n    Recipes         = require(\"../models/recipes\"),\r\n    CartView        = require(\"./cart\"),\r\n    template        = require(\"./templates/carts\"),\r\n    templateRecipes = require(\"./templates/carts-recipes\");\r\n\r\nmodule.exports = View.extend({\r\n    \"collection\": Carts,\r\n    \r\n    \"template\": template,\r\n    \"templateRecipes\": templateRecipes,\r\n\r\n    \"initialize\": function (params) {\r\n        this.allRecipes = params.recipes;\r\n        this.tags       = [];\r\n        this.recipes    = new Recipes();\r\n        this.selectPrice();\r\n    },\r\n\r\n    \"getRenderData\": function () {\r\n        return { \"recipes\": this.recipes.models }\r\n    },\r\n\r\n    \"R\": 200,\r\n    \"RDecrement\": 25,\r\n    \"RTotal\": 50,\r\n\r\n    \"drawMarks\": function (R, total) {\r\n        var out = this.r.set(),\r\n            marksAttr = { \"fill\": \"#aaa\", \"stroke\": \"none\"};\r\n\r\n        for (var value = 0; value < total; value++) {\r\n            var alpha = 360 / total * value,\r\n                    a = (90 - alpha) * Math.PI / 180,\r\n                    x = 300 + R * Math.cos(a),\r\n                    y = 300 - R * Math.sin(a);\r\n            out.push(this.r.circle(x, y, 1).attr(marksAttr));\r\n        }\r\n        return out;\r\n    },\r\n\r\n    \"render\": function () {\r\n        var data = this.getRenderData(),\r\n            R = this.R;\r\n\r\n        this.$el.html(this.template(data));\r\n        this.collection.each(function (cart){\r\n            this.add(cart);\r\n        }, this);\r\n\r\n        this.r = Raphael(\"holder\", 600, 600);\r\n        this.r.customAttributes.arc = function (value, total, R, name) {\r\n            var alpha = 360 / total * value,\r\n                a = (90 - alpha) * Math.PI / 180,\r\n                x = 300 + R * Math.cos(a),\r\n                y = 300 - R * Math.sin(a),\r\n                color = \"hsb(\".concat(Math.round(R) / 200, \",\", \r\n                             value / total, \", .75)\"),\r\n                path;\r\n            if (total == value) {\r\n                path = [[\"M\", 300, 300 - R], \r\n                        [\"A\", R, R, 0, 1, 1, 299.99, 300 - R]]; \r\n            } else {\r\n                path = [[\"M\", 300, 300 - R], \r\n                        [\"A\", R, R, 0, +(alpha > 180), 1, x, y]];\r\n            }\r\n            return { \"path\": path, \"stroke\": color, \"title\": name };\r\n        };\r\n\r\n        for (var i = 0; i < 6; i++) {\r\n            this.drawMarks(R, this.RTotal);\r\n            R -= this.RDecrement;\r\n        }\r\n        this.updateRender(data);\r\n    },\r\n\r\n    \"updateValue\": function (value, R, total, name) {\r\n        var hand,\r\n            param = { \"stroke\": \"#fff\", \"stroke-width\": 20 };\r\n        name += \" : \" + value + \" repas.\";\r\n        hand = this.r.path().attr(param).attr({ \"arc\": [0, total, R, name] });\r\n        hand.animate({ \"arc\": [value, total, R, name] }, 750, \"elastic\");\r\n    },\r\n\r\n    \"updateRender\": function (data) {\r\n        var data  = data || this.getRenderData(),\r\n            total = this.RTotal,\r\n            R     = this.R,\r\n            recipe,\r\n            tag,\r\n            tags,\r\n            i,\r\n            j,\r\n            byTag = { \"organic\": 0, \r\n                      \"cheap\": 0, \r\n                      \"quick\": 0, \r\n                      \"light\": 0,\r\n                      \"vegetarian\": 0,\r\n                      \"sugar\": 0 };\r\n\r\n        // TODO : check already checked recipes\r\n        this.$el.find(\".carts-recipes\").html(this.templateRecipes(data));\r\n\r\n        for (i = 0; i < this.allRecipes.models.length; i++) {\r\n            recipe = this.allRecipes.models[i];\r\n            tags   = recipe.get(\"tags\");\r\n            for (j = 0; j < tags.length; j++) {\r\n                tag = tags[j];\r\n                if (recipe.get(\"cooked\")) {\r\n                    byTag[tag.id] += recipe.get(\"cooked\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.updateValue(byTag[\"organic\"], R, total, \"bio\");\r\n        R -= this.RDecrement;\r\n        this.updateValue(byTag[\"cheap\"], R, total, \"pas cher\");\r\n        R -= this.RDecrement;\r\n        this.updateValue(byTag[\"quick\"], R, total, \"rapide\");\r\n        R -= this.RDecrement;\r\n        this.updateValue(byTag[\"light\"], R, total, \"light\");\r\n        R -= this.RDecrement;\r\n        this.updateValue(byTag[\"vegetarian\"], R, total, \"végétarien\");\r\n        R -= this.RDecrement;\r\n        this.updateValue(byTag[\"sugar\"], R, total, \"sucré\");\r\n    },\r\n\r\n    \"add\": function (cart) {\r\n        var cartView = new CartView({ \"model\": cart });\r\n        this.$el.find(\"ul.carts\").prepend(cartView.el)\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .recipe\": \"updateCart\",\r\n        \"click .order\": \"order\",\r\n        \"click .tag\": \"selectTag\",\r\n        \"submit .price\": \"selectPrice\",\r\n    },\r\n\r\n    \"query\": function () {\r\n        var that = this;\r\n        \r\n        this.recipes.fetch({ \r\n            \"data\": { \"tags\": this.tags,\r\n                      \"price\": this.price },\r\n            \"success\": function (data) {\r\n                that.updateRender();\r\n            }\r\n        });\r\n    },\r\n\r\n    \"selectTag\": function (evt) {\r\n        var $elem = $(evt.currentTarget),\r\n            selected,\r\n            that = this;\r\n        $(\".selected\").removeClass(\"selected\");\r\n        $elem.addClass(\"selected\");\r\n        selected  = $(\".tag.selected img\");\r\n        selected.each(function () {\r\n            var tag = $(this).attr(\"class\");\r\n            that.tags.push(tag);\r\n        });\r\n        this.query();\r\n    },\r\n\r\n    \"selectPrice\": function () {\r\n        this.price = $(\"#cart-price\").val();\r\n        this.query();\r\n\r\n        return false;\r\n    },\r\n\r\n    \"findRecipe\": function (recipeName) {\r\n        return _(this.recipes.models).find(function (recipe) { \r\n            return $.trim(recipe.get(\"name\")) == $.trim(recipeName);\r\n        });\r\n    },\r\n\r\n    \"checkedProducts\": {},\r\n\r\n    \"addProductsToCart\": function (recipe, products) {\r\n        // TODO: quantity of products and same product in diff recipe\r\n        if (!this.checkedProducts.recipe) {\r\n            this.checkedProducts[recipe] = {};\r\n        }\r\n        _(products).each(function (product) {\r\n            var productContainer = $(\"<div class='product-to-buy' />\");\r\n            productContainer.addClass(recipe);\r\n            if (!product.quantity) {\r\n                productContainer.html(product.name);\r\n                this.checkedProducts[recipe][product.name] = productContainer;\r\n                $(\"#shop .products\").append(productContainer);\r\n            }\r\n        }, this);\r\n    },\r\n\r\n    \"removeProductsFromCart\": function (recipe) {\r\n        delete this.checkedProducts[recipe];\r\n        $(\".product-to-buy.\" + recipe).remove();\r\n    },\r\n\r\n    \"updateCart\": function (evt) {\r\n        var $target    = $(evt.currentTarget),\r\n            $button    = $target.find(\".btn\"),\r\n            recipeName = $target.find(\".name\").text(),\r\n            recipe,\r\n            products;\r\n\r\n        recipe   = this.findRecipe(recipeName);\r\n        products = recipe.get(\"products\");\r\n\r\n        $button.toggleClass(\"glyphicon-unchecked\");\r\n        $button.toggleClass(\"glyphicon-check\");\r\n\r\n        recipeName = $.trim(recipeName).replace(\" \", \"\");\r\n        if ($button.hasClass(\"glyphicon-check\")) {\r\n            this.addProductsToCart(recipeName, products);\r\n        } else {\r\n            this.removeProductsFromCart(recipeName);\r\n        }\r\n    },\r\n\r\n    \"order\": function (evt) {\r\n        var checked      = $(\"#shop .recipe .glyphicon-check\"),\r\n            that         = this,\r\n            recipesNames = [],\r\n            recipeName,\r\n            cart,\r\n            products = [],\r\n            productsNames,\r\n            i, j;\r\n\r\n        recipesNames = Object.keys(this.checkedProducts);\r\n        for (i = 0; i < recipesNames.length; i++) {\r\n            recipeName    = recipesNames[i];\r\n            productsNames = Object.keys(this.checkedProducts[recipeName]);\r\n            for (j = 0; j < productsNames.length; j++) {\r\n                products.push(productsNames[j]);\r\n            }\r\n        }\r\n\r\n        cart = new Cart ({\r\n            \"name\": \"Commande : \" + recipesNames.join(\", \"),\r\n             \"products\": products\r\n            // TODO: quantity of products and same product in diff recipe\r\n        });\r\n\r\n        that.collection.create(cart, {\r\n            \"success\": function (cart) {\r\n                _(recipesNames).each(function (recipeName) {\r\n                    var recipe = that.findRecipe(recipeName);\r\n                    recipe.save({ \"toCook\": recipe.get(\"toCook\") + 1 });\r\n                });\r\n                that.add(cart);\r\n            }\r\n        });\r\n    },\r\n\r\n});\r\n","var View         = require(\"./view\"),\r\n    Carts        = require(\"../models/carts\"),\r\n    CartsView    = require(\"./carts\"),\r\n    Products     = require(\"../models/products\"),\r\n    ProductsView = require(\"./products\"),\r\n    Receipts     = require(\"../models/receipts\"),\r\n    ToCook       = require(\"../models/to_cook\"),\r\n    KitchenView  = require(\"./kitchen\"),\r\n    Recipes      = require(\"../models/recipes\"),\r\n    RecipesView  = require(\"./recipes\"),\r\n    template     = require(\"./templates/home\");\r\n\r\nmodule.exports = View.extend({\r\n    \"id\": \"home-view\",\r\n    \"template\": template,\r\n\r\n    \"events\": {\r\n        \"click .menu\": \"goMenu\",\r\n        \"click .menu .shop\": \"goShop\",\r\n        \"click .menu .fridge\": \"goFridge\",\r\n        \"click .menu .kitchen\": \"goKitchen\",\r\n        \"click .menu .recipes\": \"goRecipes\",\r\n    },\r\n\r\n    \"afterRender\": function () {\r\n        this.carts = new Carts();\r\n        this.carts.fetch({\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n\r\n        this.products = new Products();\r\n        this.products.fetch({\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n\r\n        this.recipes = new Recipes();\r\n        this.recipes.fetch({\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n\r\n        this.toCook = new ToCook();\r\n        this.toCook.fetch({\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n\r\n        this.receipts = new Receipts();\r\n        this.receipts.fetch({\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n    },\r\n\r\n    \"swipers\": {},\r\n\r\n    \"goPage\": function (pageName) {\r\n        var that = this, \r\n            pageClass = \".\" + pageName;\r\n\r\n        $(\"#content\").removeClass();\r\n        $(\"#content\").addClass(pageName);\r\n\r\n        if (!that.swipers[pageName] && pageName !== \"menu\") {\r\n            that.swipers[pageName] = $(\".swiper-container:visible\").swiper({\r\n                \"loop\": false,\r\n                \"grabCursor\": true,\r\n                \"pagination\": pageClass + \"> .pagination\",\r\n                \"paginationClickable\": true,\r\n                \"keyboardControl\": true,\r\n            });\r\n            $(pageClass + \"> .navigation.left\").on(\"click\", function (evt) {\r\n                evt.preventDefault()\r\n                that.swipers[pageName].swipePrev()\r\n            });\r\n            $(pageClass + \"> .navigation.right\").on(\"click\", function (evt) {\r\n                evt.preventDefault()\r\n                that.swipers[pageName].swipeNext()\r\n            });\r\n        } \r\n    },\r\n\r\n    \"goShop\": function () {\r\n        if (!this.cartsView) {\r\n            this.cartsView = new CartsView({ \r\n                \"el\": $(\"#shop\")[0],\r\n                \"collection\": this.carts,\r\n                \"recipes\": this.recipes\r\n            });\r\n            this.cartsView.render();\r\n        } else {\r\n            this.cartsView.updateRender();\r\n        }\r\n        this.goPage(\"shop\");\r\n\r\n        return false;\r\n    },\r\n\r\n    \"goFridge\": function () {\r\n        var that = this;\r\n\r\n        this.products.fetch({\r\n            \"success\": function () {\r\n                if (!that.productsView) {\r\n                    that.productsView = new ProductsView({ \r\n                        \"el\": $(\"#fridge\")[0],\r\n                        \"collection\": that.products\r\n                    });\r\n                    that.productsView.render();\r\n                }\r\n                that.productsView.render();\r\n                that.goPage(\"fridge\");\r\n            }\r\n        });\r\n\r\n        return false;\r\n    },\r\n\r\n    \"goKitchen\": function () {\r\n        if (!this.kitchenView) {\r\n            this.kitchenView = new KitchenView({ \r\n                \"el\": $(\"#kitchen\")[0],\r\n                \"receipts\": this.receipts,\r\n                \"toCook\": this.toCook\r\n            });\r\n            this.kitchenView.render();\r\n        } else {\r\n            this.kitchenView.updateRender(this.swipers[\"kitchen\"]);\r\n        }\r\n        this.goPage(\"kitchen\");\r\n\r\n        return false;\r\n    },\r\n\r\n    \"goRecipes\": function () {\r\n        var that = this;\r\n\r\n        this.products.fetch({\r\n            \"success\": function () {\r\n                if (!that.recipesView) {\r\n                    that.recipesView = new RecipesView({ \r\n                        \"el\": $(\"#recipes\")[0],\r\n                        \"collection\": that.recipes,\r\n                        \"products\": that.products\r\n                    });\r\n                }\r\n                that.recipesView.render();\r\n                that.goPage(\"recipes\");\r\n            }\r\n        });\r\n\r\n        return false;\r\n    },\r\n\r\n    \"goMenu\": function () {\r\n        this.goPage(\"menu\");\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n","var View         = require(\"./view\"),\r\n    Receipts     = require(\"../models/receipts\"),\r\n    ReceiptsView = require(\"./receipts\"),\r\n    ToCooksView  = require(\"./to_cooks\"),\r\n    template     = require(\"./templates/kitchen\");\r\n\r\nmodule.exports = View.extend({\r\n    \"id\": \"kitchen\",\r\n    \"template\": template,\r\n\r\n    \"initialize\": function (params) {\r\n        this.receipts = params.receipts;\r\n        this.toCook   = params.toCook;\r\n\r\n    },\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template());\r\n\r\n        this.receiptsView = new ReceiptsView({ \r\n            \"el\": $(\"#receipts\")[0],\r\n            \"collection\": this.receipts\r\n        });\r\n        this.receiptsView.render();\r\n\r\n        this.toCooksView = new ToCooksView({ \r\n            \"el\": $(\"#recipes-to-cook\")[0],\r\n            \"collection\": this.toCook\r\n        });\r\n        this.toCooksView.render();\r\n    },\r\n\r\n    \"updateRender\": function (swiper) {\r\n        this.receiptsView.updateRender();\r\n        this.toCooksView.updateRender();\r\n    },\r\n});\r\n","var View     = require(\"./view\"),\r\n    Product  = require(\"../models/product\"),\r\n    template = require(\"./templates/product\");\r\n\r\nmodule.exports = View.extend({\r\n    \"tagName\": \"li\",\r\n    \"className\": \"row product\",\r\n    \"template\": template,\r\n\r\n    \"model\": Product,\r\n\r\n    \"getRenderData\": function () { \r\n        var attributes = this.model.attributes;\r\n        if (!attributes.image) {\r\n            attributes.image = \"images/product.png\";\r\n        }\r\n        return attributes;\r\n    },\r\n\r\n    \"initialize\": function () {\r\n        this.render();\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .delete\": \"destroy\",\r\n        \"click .plus\": \"plus\",\r\n        \"click .minus\": \"minus\",\r\n    },\r\n\r\n    \"destroy\": function () {\r\n        var that = this;\r\n\r\n        $(\"#product-image\")\r\n            .val(that.$el.find(\".image img\").attr(\"src\"));\r\n        $(\"#product-name\").val(that.$el.find(\".name\").text());\r\n        $(\"#product-quantity\").val(that.$el.find(\".quantity\").text());\r\n        $(\"#product-price\").val(that.$el.find(\".price\").text());\r\n\r\n        that.model.destroy({\r\n            \"success\": function () {\r\n                that.remove();\r\n            }\r\n        });\r\n    },\r\n\r\n    \"plus\": function () {\r\n        var that = this;\r\n\r\n        that.model.save({ \"quantity\": this.model.get(\"quantity\") + 1 }, {\r\n            \"success\": function (product) {\r\n                that.render();\r\n            },\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n    },\r\n\r\n    \"minus\": function () {\r\n        var that = this;\r\n\r\n        that.model.save({ \"quantity\": this.model.get(\"quantity\") - 1 }, {\r\n            \"success\": function (product) {\r\n                that.render();\r\n            },\r\n            \"error\": function (obj, response) {\r\n                console.log(response.responseText)\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\n","var View        = require(\"./view\"),\r\n    Product     = require(\"../models/product\"),\r\n    Products    = require(\"../models/products\"),\r\n    ProductView = require(\"./product\"),\r\n    template    = require(\"./templates/products\");\r\n\r\nmodule.exports = View.extend({\r\n    \"collection\": Products,\r\n    \r\n    \"template\": template,\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template(this.getRenderData()));\r\n        this.oldProducts = this.$el.find(\"ul.products.old\");\r\n        this.newProducts = this.$el.find(\"ul.products.new\");\r\n        this.collection.each(function (product){\r\n            this.add(product, this.oldProducts);\r\n        }, this);\r\n        this.searchList = new List(this.$el.find(\".products-list\")[0], \r\n                                   { \"valueNames\": [\"name\", \r\n                                                    \"price\", \r\n                                                    \"quantity\"] });\r\n    },\r\n\r\n    \"add\": function (product, list) {\r\n        var productView = new ProductView({ \"model\": product });\r\n        if (!list) {\r\n            list = this.newProducts;\r\n        }\r\n        list.prepend(productView.el);\r\n    },\r\n\r\n    \"events\": {\r\n        \"submit form\": \"addProduct\",\r\n        \"click .old .delete\": \"removeFromList\"\r\n    },\r\n\r\n    \"addProduct\": function (evt) {\r\n        var $form = $(evt.target),\r\n            product = new Product ({\r\n                \"name\": $(\"#product-name\").val(),\r\n                \"quantity\": $(\"#product-quantity\").val(),\r\n                \"price\": $(\"#product-price\").val(),\r\n                \"image\": $(\"#product-image\").val()\r\n            }),\r\n            that = this;\r\n\r\n        this.collection.create(product, {\r\n            \"success\": function (product) {\r\n                that.add(product);\r\n                $(\"#product-name\").val(\"\");\r\n                $(\"#product-quantity\").val(\"\");\r\n                $(\"#product-price\").val(\"\");\r\n                $(\"#product-image\").val(\"\");\r\n            }\r\n        });\r\n\r\n        return false;\r\n    },\r\n\r\n    \"removeFromList\": function (evt) {\r\n        var productName = $(evt.target).parents(\"li\").find(\".name\").text();\r\n        this.searchList.remove(\"name\", $.trim(productName));\r\n    }\r\n});\r\n","var View           = require(\"./view\"),\r\n    Product        = require(\"../models/product\"),\r\n    Products       = require(\"../models/products\"),\r\n    Receipt        = require(\"../models/receipt\"),\r\n    template       = require(\"./templates/receipt\"),\r\n    templateDetail = require(\"./templates/receipt-detail\");\r\n\r\nmodule.exports = View.extend({\r\n    \"tagName\": \"li\",\r\n    \"className\": \"row receipt\",\r\n    \"template\": template,\r\n    \"templateDetail\": templateDetail,\r\n\r\n    \"model\": Receipt,\r\n\r\n    \"initialize\": function () {\r\n        this.render();\r\n    },\r\n\r\n    \"getRenderData\": function () { \r\n        var attributes = this.model.attributes;\r\n        attributes.date = new Date(attributes.timestamp).toString(\"d/M/yyyy\");\r\n        return attributes;\r\n    },\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template(this.getRenderData()));\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .validate\": \"validate\",\r\n        \"click\": \"displayDetails\"\r\n    },\r\n\r\n    \"displayDetails\": function () {\r\n        var that = this;\r\n\r\n        if (that.$el.find(\".details\").length) {\r\n            that.$el.find(\".details\").remove();\r\n        } else {\r\n            this.model.fetch({ \r\n                \"success\": function (detailed) {\r\n                    var $ul = $(\"<ul class='details' />\"),\r\n                        $li,\r\n                        detail,\r\n                        details,\r\n                        i;\r\n                    that.$el.append($ul);\r\n                    details = detailed.get(\"details\");\r\n                    for (i = 0; i < details.length; i++) {\r\n                        detail = details[i];\r\n                        if (!detail.label) {\r\n                            detail.label = \"\";\r\n                        }\r\n                        $ul.append(that.templateDetail(details[i]));\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    \"validate\": function (evt) {\r\n        var that    = this,\r\n            $target = $(evt.target);\r\n\r\n        $target.removeClass(\"btn-info\");\r\n        $target.addClass(\"btn-warning\");\r\n        this.model.fetch({ \r\n            \"success\": function (detailed) {\r\n                Products.prototype.addProducts(detailed.get(\"details\"), \r\n                                               function () {\r\n                    $target.removeClass(\"btn-warning\");\r\n                    $target.addClass(\"btn-success\");\r\n                });\r\n            },\r\n            \"error\": function (data) {\r\n                $target.removeClass(\"btn-warning\");\r\n                $target.addClass(\"btn-error\");\r\n            }\r\n        });\r\n        return false;\r\n    }\r\n});\r\n","var View        = require(\"./view\"),\r\n    Receipt     = require(\"../models/receipt\"),\r\n    Receipts    = require(\"../models/receipts\"),\r\n    ReceiptView = require(\"./receipt\"),\r\n    template    = require(\"./templates/receipts\");\r\n\r\nmodule.exports = View.extend({\r\n    \"collection\": Receipts,\r\n    \r\n    \"template\": template,\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template(this.getRenderData()));\r\n        this.receiptsList = this.$el.find(\"ul.receipts\");\r\n        this.collection.each(function (receipt){\r\n            this.add(receipt);\r\n        }, this);\r\n    },\r\n\r\n    \"updateRender\": function (swiper) {\r\n        console.log(\"this is a prototype, recepts list doesnt update\")\r\n    },\r\n\r\n    \"add\": function (receipt) {\r\n        var receiptView = new ReceiptView({ \"model\": receipt, \r\n                                            \"products\": this.products });\r\n        this.receiptsList.prepend(receiptView.el);\r\n    },\r\n});\r\n","var View     = require(\"./view\"),\r\n    Recipe   = require(\"../models/recipe\"),\r\n    template = require(\"./templates/recipe\");\r\n\r\nmodule.exports = View.extend({\r\n    \"tagName\": \"li\",\r\n    \"className\": \"row recipe\",\r\n    \"template\": template,\r\n\r\n    \"model\": Recipe,\r\n\r\n    \"getRenderData\": function () { \r\n        var attributes = this.model.attributes;\r\n        if (!attributes.image) {\r\n            attributes.image = \"images/recipe.png\";\r\n        }\r\n        if (attributes.description) {\r\n            attributes.description = \r\n                attributes.description.replace(/[\\r\\n]+/g, \"<br>\");\r\n        }\r\n        return attributes;\r\n    },\r\n\r\n    \"initialize\": function () {\r\n        this.render();\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .delete\": \"destroy\",\r\n    },\r\n\r\n    \"destroy\": function () {\r\n        var that = this,\r\n            $recipesProducts = $(\"#recipe-products\"),\r\n            $recipesTags = $(\"#recipe-tags\");\r\n\r\n        $(\"#recipe-image\")\r\n            .val(that.$el.find(\".image img\").attr(\"src\"));\r\n        $(\"#recipe-name\").val(that.$el.find(\".name\").text());\r\n        $(\"#recipe-description\")\r\n            .val(that.$el.find(\".description\")\r\n                    .html()\r\n                    .replace(/<br>/gi, \"\\n\"));\r\n\r\n        $recipesProducts.find(\"options:selected\").prop(\"selected\", false);\r\n        that.$el.find(\".recipe-products li\").each(function () {\r\n            $recipesProducts.find(\"option[value='\" + $(this).text() + \"']\")\r\n                .prop(\"selected\", true);\r\n        });\r\n        that.$el.find(\".recipe-tags span\").each(function () {\r\n            $recipesTags.find(\"option[value='\" + $.trim($(this).text()) + \"']\")\r\n                .prop(\"selected\", true);\r\n        });\r\n        $(\".select-picker\").selectpicker(\"refresh\");\r\n\r\n        that.model.destroy({\r\n            \"success\": function () {\r\n                that.remove();\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\n","var View       = require(\"./view\"),\r\n    Recipe     = require(\"../models/recipe\"),\r\n    Recipes    = require(\"../models/recipes\"),\r\n    RecipeView = require(\"./recipe\"),\r\n    template   = require(\"./templates/recipes\");\r\n\r\nmodule.exports = View.extend({\r\n    \"collection\": Recipes,\r\n    \r\n    \"template\": template,\r\n\r\n    \"initialize\": function (params) {\r\n        this.products = params.products.models;\r\n    },\r\n\r\n    \"getRenderData\": function () {\r\n        return { \"products\": this.products };\r\n    },\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template(this.getRenderData()));\r\n        this.$el.find(\".select-picker\").selectpicker({\r\n            \"title\": \"aucun produit\",\r\n            \"noneResultsText\": \"aucun produit contenant\"\r\n        });\r\n        this.collection.each(function (recipe){\r\n            this.add(recipe);\r\n        }, this);\r\n    },\r\n\r\n    \"add\": function (recipe) {\r\n        var recipeView = new RecipeView({ \"model\": recipe });\r\n        this.$el.find(\"ul.recipes\").prepend(recipeView.el)\r\n    },\r\n\r\n    \"events\": {\r\n        \"submit form\": \"addRecipe\",\r\n    },\r\n\r\n    \"addRecipe\": function (evt) {\r\n        var $form = $(evt.target),\r\n            recipe = new Recipe ({\r\n                \"name\": $(\"#recipe-name\").val(),\r\n                \"description\": $(\"#recipe-description\").val(),\r\n                \"products\": $(\"#recipe-products\").val(),\r\n                \"tags\": $(\"#recipe-tags\").val(),\r\n                \"image\": $(\"#recipe-image\").val(),\r\n                \"toCook\": false\r\n            }),\r\n            that = this;\r\n\r\n        if (!recipe.get(\"image\")) {\r\n            recipe.image = \"images/recipe.png\";\r\n        }\r\n        that.collection.create(recipe, {\r\n            \"success\": function (recipe) {\r\n                that.add(recipe);\r\n            }\r\n        });\r\n\r\n        return false;\r\n    },\r\n\r\n});\r\n","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<span title=\"supprimer\" class=\"delete\"><button class=\"btn btn-danger glyphicon glyphicon-remove\"></button></span><span class=\"name\">' + escape((interp = name) == null ? '' : interp) + '</span><ul>');\n// iterate products\n;(function(){\n  if ('number' == typeof products.length) {\n    for (var $index = 0, $$l = products.length; $index < $$l; $index++) {\n      var product = products[$index];\n\nbuf.push('<li class=\"product\">+ ' + escape((interp = product.id) == null ? '' : interp) + ' </li>');\n    }\n  } else {\n    for (var $index in products) {\n      var product = products[$index];\n\nbuf.push('<li class=\"product\">+ ' + escape((interp = product.id) == null ? '' : interp) + ' </li>');\n   }\n  }\n}).call(this);\n\nbuf.push('</ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\n// iterate recipes\n;(function(){\n  if ('number' == typeof recipes.length) {\n    for (var $index = 0, $$l = recipes.length; $index < $$l; $index++) {\n      var recipe = recipes[$index];\n\nbuf.push('<div class=\"recipe\"> <span class=\"name\">' + escape((interp = recipe.attributes.name) == null ? '' : interp) + '<div class=\"btn glyphicon glyphicon-unchecked\"> </div></span></div>');\n    }\n  } else {\n    for (var $index in recipes) {\n      var recipe = recipes[$index];\n\nbuf.push('<div class=\"recipe\"> <span class=\"name\">' + escape((interp = recipe.attributes.name) == null ? '' : interp) + '<div class=\"btn glyphicon glyphicon-unchecked\"> </div></span></div>');\n   }\n  }\n}).call(this);\n\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"navigation left\"></div><div class=\"swiper-container\"><div class=\"swiper-wrapper\"><div class=\"swiper-slide\"> <h2>Informations de consommation</h2><div class=\"history\"><div id=\"holder\"></div></div></div><div class=\"swiper-slide\"> <h2>Choix des catégories</h2><div class=\"tags\"><div class=\"row\"><div class=\"col-xs-offset-4 col-xs-2\"><span class=\"tag\"><img alt=\"pas cher\" class=\"cheap\"/></span></div><div class=\"col-xs-2\"><span class=\"tag\"><img alt=\"rapide\" class=\"quick\"/></span></div></div><div class=\"row\"><div class=\"col-xs-offset-4 col-xs-2\"><span class=\"tag\"><img alt=\"bio\" class=\"organic\"/></span></div><div class=\"col-xs-2\"><span class=\"tag\"><img alt=\"light\" class=\"light\"/></span></div></div><div class=\"row\"><div class=\"col-xs-offset-4 col-xs-2\"><span class=\"tag\"><img alt=\"végétarien\" class=\"vegetarian\"/></span></div><div class=\"col-xs-2\"><span class=\"tag\"><img alt=\"sucré\" class=\"sugar\"/></span></div></div></div><h2>Choix du prix</h2><form class=\"price row\"><div class=\"form-group col-xs-offset-4 col-xs-4\"><input id=\"cart-price\" placeholder=\"Prix\" required=\"required\" value=\"10\" name=\"price\" class=\"form-control\"/></div></form></div><div class=\"swiper-slide carts\"><div class=\"row\"><div class=\"choose-recipe col-xs-6\"><h2>Choix de la recette</h2><div class=\"carts-recipes\"></div></div><div class=\"choose-products col-xs-6\"><h2>Panier</h2><div class=\"products\"></div></div></div><hr/><div class=\"btn btn-primary order\">Commander</div><hr/><h2>Commandes en cours</h2><ul class=\"carts row\"></ul></div></div></div><div class=\"navigation right\"></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div id=\"content\" class=\"menu\"><div class=\"header\"><div class=\"menu\"><a class=\"menu\"><img src=\"images/title.png\" alt=\"aliventaire\" title=\"Aliventaire\"/></a></div><div class=\"shop\"><a href=\"/\" class=\"menu\"><img src=\"images/shop.png\" alt=\"shop\" title=\"Retour au menu\" class=\"menu\"/></a><h1>Mes courses</h1><div class=\"pagination\"></div></div><div class=\"fridge\"><a href=\"/\" class=\"menu\"><img src=\"images/fridge.png\" alt=\"fridge\" title=\"Retour au menu\" class=\"menu\"/></a><h1>Mon placard</h1><div class=\"pagination\"></div></div><div class=\"kitchen\"><a href=\"/\" class=\"menu\"><img src=\"images/kitchen.png\" alt=\"kitchen\" title=\"Retour au menu\" class=\"menu\"/></a><h1>Ma cuisine</h1><div class=\"pagination\"></div></div><div class=\"recipes\"><a href=\"/\" class=\"menu\"><img src=\"images/recipes.png\" alt=\"recipes\" title=\"Retour au menu\" class=\"menu\"/></a><h1>Mes recettes</h1><div class=\"pagination\"></div></div></div><div class=\"page\"><div class=\"menu\"><div class=\"row\"><a href=\"/\" class=\"shop\"><img src=\"images/shop.png\" alt=\"shop\" title=\"Mes courses\" class=\"shop\"/></a><a href=\"/\" class=\"fridge\"><img src=\"images/fridge.png\" alt=\"fridge\" title=\"Mon placard\" class=\"fridge\"/></a></div><div class=\"row\"><a href=\"/\" class=\"kitchen\"><img src=\"images/kitchen.png\" alt=\"kitchen\" title=\"Ma cuisine\" class=\"kitchen\"/></a><a href=\"/\" class=\"recipes\"><img src=\"images/recipes.png\" alt=\"recipes\" title=\"Mes recettes\" class=\"recipes\"/></a></div></div><div id=\"shop\" class=\"shop\"></div><div id=\"fridge\" class=\"fridge\"></div><div id=\"kitchen\" class=\"kitchen\"></div><div id=\"recipes\" class=\"recipes\"></div></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"kitchen\"><div class=\"navigation left\"></div><div class=\"swiper-container\"><div class=\"swiper-wrapper\"><div class=\"swiper-slide\"> <h2>Tickets de caisse</h2><h3>Validez les tickets de caisse pour mettre les produits dans le frigo !</h3><div id=\"receipts\"></div></div><div class=\"swiper-slide\"> <h2>Recette à cuisiner</h2><h3>Validez les recettes à cuisiner pour enlever les produits du frigo !</h3><div id=\"recipes-to-cook\"></div></div></div></div><div class=\"navigation right\"></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div title=\"supprimer\" class=\"delete col-xs-1\"><button class=\"btn btn-danger\"><span class=\"glyphicon glyphicon-remove\"></span></button></div><div class=\"image col-xs-1\"> <img');\nbuf.push(attrs({ 'src':(\"\" + (image) + \"\"), 'alt':(\"\"), 'title':(\"\" + (name) + \"\") }, {\"src\":true,\"alt\":true,\"title\":true}));\nbuf.push('/></div><div class=\"name col-xs-5\">' + escape((interp = name) == null ? '' : interp) + '</div><div class=\"price col-xs-2\">' + escape((interp = price) == null ? '' : interp) + '</div><div class=\"quantity col-xs-3\">' + escape((interp = quantity) == null ? '' : interp) + '<span class=\"actions\"><button class=\"minus btn btn-default\"><span class=\"glyphicon glyphicon-minus\"></span></button><button class=\"plus btn btn-default\"><span class=\"glyphicon glyphicon-plus\"></span></button></span></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<form role=\"form\" class=\"form-inline\"><div class=\"row\"><div class=\"form-group col-xs-7\"><input id=\"product-name\" type=\"text\" required=\"required\" placeholder=\"Produit\" class=\"form-control\"/></div><div class=\"form-group col-xs-2\"><input id=\"product-price\" type=\"text\" required=\"required\" pattern=\"[0-9]+(.[0-9]+)?\" title=\"le prix unitaire de ce produit (ex: 3.2)\" placeholder=\"Prix unitaire\" class=\"form-control\"/></div><div class=\"form-group col-xs-2\"><input id=\"product-quantity\" type=\"text\" pattern=\"[0-9]+\" title=\"le nombre de produits de ce type\" placeholder=\"Quantité\" class=\"form-control\"/></div><div class=\"col-xs-1\"><button type=\"submit\" title=\"ajouter\" class=\"btn btn-default\"><span class=\"glyphicon glyphicon-plus\"></span></button></div></div><div class=\"row\"><div class=\"form-group col-xs-11\"><input id=\"product-image\" type=\"text\" placeholder=\"adresse de l\\'image\" class=\"form-control\"/></div></div></form><div class=\"products-list\"><ul class=\"products new\"></ul><hr/><div class=\"row\"><div class=\"form-group col-xs-10 col-xs-offset-2\"><input type=\"text\" placeholder=\"filtrer\" class=\"search form-control\"/></div></div><div class=\"row\"><button title=\"trier par nom\" data-sort=\"name\" class=\"sort btn btn-default col-xs-5 col-xs-offset-2\"><span class=\"glyphicon glyphicon-sort\"></span>nom</button><button title=\"trier par prix\" data-sort=\"price\" class=\"sort btn btn-default col-xs-2\"> <span class=\"glyphicon glyphicon-sort\"></span>prix</button><button title=\"trier par quantité\" data-sort=\"quantity\" class=\"sort btn btn-default col-xs-3\"> <span class=\"glyphicon glyphicon-sort\"></span>quantité</button></div><ul class=\"products old list\"></ul></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<li class=\"row\"><span class=\"col-xs-1\">' + escape((interp = amount) == null ? '' : interp) + '</span><span class=\"col-xs-8\">' + escape((interp = label) == null ? '' : interp) + '</span><span class=\"col-xs-3\">' + escape((interp = price) == null ? '' : interp) + '</span></li>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"transaction col-xs-3\">' + escape((interp = date) == null ? '' : interp) + '</div><div title=\"afficher le détail du ticket de caisse\" class=\"receipt-id col-xs-3\">' + escape((interp = receiptId) == null ? '' : interp) + '</div><div class=\"total col-xs-3\">' + escape((interp = total) == null ? '' : interp) + '</div><div title=\"valider\" class=\"validate col-xs-3\"><button class=\"btn btn-info\"><span class=\"glyphicon glyphicon-check\"></span></button></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<ul class=\"receipts\"></ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div class=\"image col-xs-3\"> <img');\nbuf.push(attrs({ 'src':(\"\" + (image) + \"\"), 'alt':(\"image\"), 'title':(\"\" + (name) + \"\") }, {\"src\":true,\"alt\":true,\"title\":true}));\nbuf.push('/></div><div class=\"col-xs-8\"> <div class=\"name\"> <span title=\"supprimer\" class=\"delete\"><button class=\"btn btn-danger\"><span class=\"glyphicon glyphicon-remove\"></span></button></span><span>' + escape((interp = name) == null ? '' : interp) + '</span></div><div class=\"recipe-tags\"> ');\n// iterate tags\n;(function(){\n  if ('number' == typeof tags.length) {\n    for (var $index = 0, $$l = tags.length; $index < $$l; $index++) {\n      var tag = tags[$index];\n\nbuf.push('<span class=\"tag\">' + escape((interp = tag.id) == null ? '' : interp) + ' </span>');\n    }\n  } else {\n    for (var $index in tags) {\n      var tag = tags[$index];\n\nbuf.push('<span class=\"tag\">' + escape((interp = tag.id) == null ? '' : interp) + ' </span>');\n   }\n  }\n}).call(this);\n\nbuf.push('</div><div class=\"description\">' + ((interp = description) == null ? '' : interp) + '</div><hr/><div class=\"recipe-products\">Produits :<ul>');\n// iterate products\n;(function(){\n  if ('number' == typeof products.length) {\n    for (var $index = 0, $$l = products.length; $index < $$l; $index++) {\n      var product = products[$index];\n\nbuf.push('<li>' + escape((interp = product.name) == null ? '' : interp) + '</li>');\n    }\n  } else {\n    for (var $index in products) {\n      var product = products[$index];\n\nbuf.push('<li>' + escape((interp = product.name) == null ? '' : interp) + '</li>');\n   }\n  }\n}).call(this);\n\nbuf.push('</ul></div></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<form role=\"form\"><div class=\"form-group\"><input id=\"recipe-name\" type=\"text\" required=\"required\" placeholder=\"Nom de la recette\" class=\"form-control\"/></div><div class=\"form-group col-xs-6\"><textarea id=\"recipe-description\" type=\"text\" placeholder=\"Description de la recette\" class=\"form-control\"></textarea></div><div class=\"form-group col-xs-6\"><label for=\"recipe-products\">Produits nécessaires :</label><select id=\"recipe-products\" multiple=\"multiple\" data-live-search=\"true\" class=\"form-control select-picker\">');\n// iterate products\n;(function(){\n  if ('number' == typeof products.length) {\n    for (var $index = 0, $$l = products.length; $index < $$l; $index++) {\n      var product = products[$index];\n\nbuf.push('<option');\nbuf.push(attrs({ 'value':(\"\" + (product.attributes.name) + \"\") }, {\"value\":true}));\nbuf.push('> \\n' + escape((interp = product.attributes.name) == null ? '' : interp) + '</option>');\n    }\n  } else {\n    for (var $index in products) {\n      var product = products[$index];\n\nbuf.push('<option');\nbuf.push(attrs({ 'value':(\"\" + (product.attributes.name) + \"\") }, {\"value\":true}));\nbuf.push('> \\n' + escape((interp = product.attributes.name) == null ? '' : interp) + '</option>');\n   }\n  }\n}).call(this);\n\nbuf.push('</select><label for=\"recipe-products\">Catégoriess :</label><select id=\"recipe-tags\" multiple=\"multiple\" class=\"form-control select-picker\"><option value=\"cheap\">pas cher</option><option value=\"quick\">rapide</option><option value=\"organic\">bio</option><option value=\"light\">light</option><option value=\"vegetarian\">végétarien</option><option value=\"sugar\">sucré</option></select></div><div class=\"form-group\"><input id=\"recipe-image\" type=\"text\" placeholder=\"adresse de l\\'image\" class=\"form-control\"/></div><div class=\"form-group\"><button type=\"submit\" title=\"ajouter\" class=\"btn btn-default\"><span class=\"glyphicon glyphicon-plus\"></span></button></div></form><ul class=\"recipes\"></ul>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<ul class=\"recipes\"></ul>');\n}\nreturn buf.join(\"\");\n};","var View     = require(\"./view\"),\r\n    Recipe   = require(\"../models/recipe\"),\r\n    Product  = require(\"../models/product\"),\r\n    Products = require(\"../models/products\"),\r\n    template = require(\"./templates/recipe\");\r\n\r\nmodule.exports = View.extend({\r\n    \"tagName\": \"li\",\r\n    \"className\": \"row recipe\",\r\n    \"template\": template,\r\n\r\n    \"model\": Recipe,\r\n\r\n    \"getRenderData\": function () { \r\n        var attributes = this.model.attributes;\r\n        if (!attributes.image) {\r\n            attributes.image = \"images/recipe.png\";\r\n        }\r\n        if (attributes.description) {\r\n            attributes.description = \r\n                attributes.description.replace(/[\\r\\n]+/g, \"<br>\");\r\n        }\r\n        return attributes;\r\n    },\r\n\r\n    \"initialize\": function () {\r\n        this.render();\r\n    },\r\n\r\n    \"events\": {\r\n        \"click .delete\": \"destroy\",\r\n    },\r\n\r\n    \"destroy\": function () {\r\n        var that = this,\r\n            i,\r\n            product,\r\n            products = this.model.get(\"products\"),\r\n            details = [];\r\n\r\n        for (var i = 0; i < products.length; i++) {\r\n            product = products[i];\r\n            details.push({ \"label\": product.name, \"amount\": -1 })\r\n        }\r\n        Products.prototype.removeProducts(details, function () {\r\n            var cooked,\r\n                toCook;\r\n            // TODO: increment and decrement toCook in a model function\r\n            //       to prevent < 0\r\n            toCook = that.model.get(\"toCook\") - 1;\r\n            cooked = that.model.get(\"cooked\");\r\n            if (cooked) {\r\n                cooked++;\r\n            } else {\r\n                cooked = 1;\r\n            }\r\n            that.model.save({ \"toCook\": toCook, \"cooked\": cooked }, {\r\n                \"success\": function (data) {\r\n                    if (!data.attributes.toCook) {\r\n                        that.remove();\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n});\r\n","var View       = require(\"./view\"),\r\n    Recipe     = require(\"../models/recipe\"),\r\n    ToCook     = require(\"../models/to_cook\"),\r\n    ToCookView = require(\"./to_cook\"),\r\n    template   = require(\"./templates/to_cooks\");\r\n\r\nmodule.exports = View.extend({\r\n    \"collection\": ToCook,\r\n    \r\n    \"template\": template,\r\n\r\n    \"render\": function () {\r\n        var that = this;\r\n        this.$el.html(this.template(this.getRenderData()));\r\n\r\n        this.recipesList = this.$el.find(\"ul.recipes\");\r\n        this.collection.each(function (recipe){\r\n            that.add(recipe);\r\n        });\r\n    },\r\n\r\n    \"updateRender\": function (swiper) {\r\n        var that = this,\r\n            $recipes = this.recipesList;\r\n\r\n        $recipes.html(\"\");\r\n        that.collection.fetch({\r\n            \"success\": function (collection) {\r\n                that.collection = collection;\r\n                that.height = 0;\r\n                collection.each(function (recipe){\r\n                    that.add(recipe);\r\n                });\r\n                // TODO: see how to solve this :\r\n                // idangerous doesnt update his heigth after dom change ...\r\n                $recipes.height(that.height);\r\n                $recipes.parents(\".swiper-slide\").height(that.height + 500);\r\n                $recipes.parents(\".swiper-wrapper\").height(that.height + 500);\r\n                swiper.resizeFix();\r\n            }\r\n        });\r\n    },\r\n\r\n    \"add\": function (recipe) {\r\n        var recipeView = new ToCookView({ \"model\": recipe }),\r\n            $recipes = this.recipesList;\r\n        $recipes.prepend(recipeView.el);\r\n\r\n        this.height = this.height + recipeView.$el.height();\r\n    },\r\n});\r\n","require('lib/view_helper');\r\n\r\n// Base class for all views.\r\nmodule.exports = Backbone.View.extend({\r\n    \"initialize\": function () {\r\n        this.render = _.bind(this.render, this);\r\n    },\r\n\r\n    \"template\": function () { return null; },\r\n    \"getRenderData\": function () { return null; },\r\n\r\n    \"render\": function () {\r\n        this.$el.html(this.template(this.getRenderData()));\r\n        this.afterRender();\r\n        return this;\r\n    },\r\n\r\n    \"afterRender\": function () { return null; }\r\n});\r\n"]}